"use strict";(self.webpackChunkchemotion_saurus=self.webpackChunkchemotion_saurus||[]).push([[9538],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return u}});var o=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=o.createContext({}),d=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=d(e.components);return o.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=d(n),u=i,h=m["".concat(s,".").concat(u)]||m[u]||c[u]||a;return n?o.createElement(h,r(r({ref:t},p),{},{components:n})):o.createElement(h,r({ref:t},p))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,r=new Array(a);r[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,r[1]=l;for(var d=2;d<a;d++)r[d]=n[d];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},2639:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return d},toc:function(){return p},default:function(){return m}});var o=n(7462),i=n(3366),a=(n(7294),n(3905)),r=["components"],l={id:"dev_docker_install",title:"Docker Installation",sidebar_label:"Docker installation",slug:"development_docker_installation"},s=void 0,d={unversionedId:"eln/dev_docker_install",id:"version-1.1.1/eln/dev_docker_install",title:"Docker Installation",description:"Documentation and processes are being reworked and improved at the moment. Please contact us for installation of a development version of the ELN.",source:"@site/versioned_docs/version-1.1.1/eln/dev_docker_install.mdx",sourceDirName:"eln",slug:"/eln/development_docker_installation",permalink:"/chemotionsaurus/docs/eln/development_docker_installation",editUrl:"https://github.com/ComPlat/chemotion_saurus/edit/master/versioned_docs/version-1.1.1/eln/dev_docker_install.mdx",tags:[],version:"1.1.1",lastUpdatedBy:"Jan C. Brammer",lastUpdatedAt:1655807396,formattedLastUpdatedAt:"6/21/2022",frontMatter:{id:"dev_docker_install",title:"Docker Installation",sidebar_label:"Docker installation",slug:"development_docker_installation"},sidebar:"elnSidebar",previous:{title:"Native installation",permalink:"/chemotionsaurus/docs/eln/development_native_installation"},next:{title:"Development",permalink:"/chemotionsaurus/docs/category/development"}},p=[{value:"Introductions",id:"introductions",children:[],level:2},{value:"Prerequisites",id:"prerequisites",children:[],level:2},{value:"Windows",id:"windows-heading-id",children:[{value:"Dependencies",id:"dependencies",children:[{value:"WSL 2",id:"wsl-2",children:[],level:4},{value:"Docker Desktop",id:"docker-desktop",children:[],level:4}],level:3},{value:"Setup",id:"setup",children:[],level:3}],level:2},{value:"Linux",id:"linux-heading-id",children:[{value:"Dependencies",id:"dependencies-1",children:[],level:3},{value:"Setup",id:"setup-1",children:[{value:"docker group",id:"docker-group",children:[],level:4}],level:3}],level:2},{value:"macOS",id:"macos-heading-id",children:[],level:2},{value:"ELN in a Docker container",id:"eln-in-docker",children:[{value:"Development Mode Setup",id:"development-mode-setup",children:[],level:3},{value:"Production Mode Setup",id:"production-mode-setup",children:[],level:3}],level:2},{value:"ELN in a Visual Studio Code devcontainer",id:"eln-in-devcontainer",children:[],level:2},{value:"Tools recommended for development",id:"tools-recommended-for-development",children:[{value:"Visual Studio Code",id:"visual-studio-code",children:[],level:3}],level:2}],c={toc:p};function m(e){var t=e.components,n=(0,i.Z)(e,r);return(0,a.kt)("wrapper",(0,o.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"Documentation and processes are being reworked and improved at the moment. Please ",(0,a.kt)("a",{parentName:"p",href:"specific_contact"},"contact")," us for installation of a development version of the ELN."))),(0,a.kt)("h2",{id:"introductions"},"Introductions"),(0,a.kt)("p",null,'Containers enable the use of isolated, consistent, and portable development environments. When using containers for development you will not have to install and configure the Chemotion ELN locally on your machine.\nInstead, dependencies and configurations are maintained in container-images which you can run on your machine using Docker.\nThis keeps your machine free of clutter, and more importantly, it can ensure consistent development environments across contributors (i.e., avoiding "works on my machine" scenarios).\nHave a look at this ',(0,a.kt)("a",{parentName:"p",href:"https://carpentries-incubator.github.io/docker-introduction/01-introduction/index.html"},"tutorial")," for an accessible introduction to containers."),(0,a.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("p",null,"This guide assumes you are familiar with basic operation of Git, Docker and a Linux operating system.\nAt minimum, your hardware setup should feature 3 GB RAM and 20 GB disk capacity (it is advisable to assign considerably more resources)."),(0,a.kt)("h2",{id:"windows-heading-id"},"Windows"),(0,a.kt)("p",null,"This guide will help you getting started developing with containers on Windows using ",(0,a.kt)("inlineCode",{parentName:"p"},"Docker Desktop")," along with ",(0,a.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows/wsl/about"},"Windows Subsystem for Linux")," (referred to as ",(0,a.kt)("inlineCode",{parentName:"p"},"WSL 2")," in the following).\nWith ",(0,a.kt)("inlineCode",{parentName:"p"},"Docker Desktop")," you can work in a Linux-based development environment and run Linux-based containers while using an IDE on Windows for editing and debugging (e.g., Visual Studio Code).\nThe instructions have been tested on Windows 10. Your machine should run Windows 10, version 2004, Build 18362 or higher."),(0,a.kt)("h3",{id:"dependencies"},"Dependencies"),(0,a.kt)("h4",{id:"wsl-2"},"WSL 2"),(0,a.kt)("p",null,"Start by ",(0,a.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows/wsl/install-win10"},"installing ",(0,a.kt)("inlineCode",{parentName:"a"},"WSL 2")),"."),(0,a.kt)("div",{className:"admonition admonition-important alert alert--info"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"important")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"While going through the ",(0,a.kt)("inlineCode",{parentName:"p"},"WSL 2")," installation, make sure to install ",(0,a.kt)("inlineCode",{parentName:"p"},"WSL 2"),", not ",(0,a.kt)("inlineCode",{parentName:"p"},"WSL 1"),". Also, make sure to install ",(0,a.kt)("inlineCode",{parentName:"p"},"Ubuntu 20.04 LTS")," (referred to as ",(0,a.kt)("inlineCode",{parentName:"p"},"Ubuntu")," in the following) as your Linux distribution. You may need to upgrade ",(0,a.kt)("inlineCode",{parentName:"p"},"Ubuntu 20.04 LTS")," from ",(0,a.kt)("inlineCode",{parentName:"p"},"WSL 1")," to ",(0,a.kt)("inlineCode",{parentName:"p"},"WSL 2"),". To check if you have the correct version, open powershell and enter the command"),(0,a.kt)("pre",{parentName:"div"},(0,a.kt)("code",{parentName:"pre"},"wsl.exe -l -v\n")),(0,a.kt)("p",{parentName:"div"},"If this shows version 1 for ",(0,a.kt)("inlineCode",{parentName:"p"},"Ubuntu 20.04 LTS")," upgrade to ",(0,a.kt)("inlineCode",{parentName:"p"},"WSL 2")," with the command"),(0,a.kt)("pre",{parentName:"div"},(0,a.kt)("code",{parentName:"pre"},"wsl.exe --set-version Ubuntu-20.04 2\n")))),(0,a.kt)("p",null,"Next, ",(0,a.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows/wsl/wsl-config#ways-to-run-wsl"},"open an ",(0,a.kt)("inlineCode",{parentName:"a"},"Ubuntu")," terminal")," and ",(0,a.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows/wsl/user-support"},"set up a user account"),"."),(0,a.kt)("h4",{id:"docker-desktop"},"Docker Desktop"),(0,a.kt)("p",null,"Once you have set up ",(0,a.kt)("inlineCode",{parentName:"p"},"WSL 2")," you can ",(0,a.kt)("a",{parentName:"p",href:"https://docs.docker.com/docker-for-windows/wsl/"},"install ",(0,a.kt)("inlineCode",{parentName:"a"},"Docker Desktop")," and enable the ",(0,a.kt)("inlineCode",{parentName:"a"},"WSL 2")," backend in ",(0,a.kt)("inlineCode",{parentName:"a"},"Docker Desktop")),".\nFor additional information and prerequisites regarding the installation of ",(0,a.kt)("inlineCode",{parentName:"p"},"Docker Desktop")," also have a look ",(0,a.kt)("a",{parentName:"p",href:"https://docs.docker.com/docker-for-windows/install/"},"here")," (the instructions above should be sufficient though)."),(0,a.kt)("h3",{id:"setup"},"Setup"),(0,a.kt)("p",null,"Once you have ",(0,a.kt)("inlineCode",{parentName:"p"},"WSL 2")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"Docker Desktop")," installed, you can start setting up the Chemotion ELN development environment.\nThe development environment consists of the Chemotion ELN source code as well as two Docker images containing all dependencies and configurations of the Chemotion ELN runtime."),(0,a.kt)("p",null,"Make sure that all files you'll download in the following steps live in the Linux file system, ",(0,a.kt)("em",{parentName:"p"},"not")," in your Windows file system (",(0,a.kt)("a",{parentName:"p",href:"https://docs.docker.com/docker-for-windows/wsl/#best-practices"},"here's why"),").\nThe Windows file system (e.g., C: drive) is mounted into ",(0,a.kt)("inlineCode",{parentName:"p"},"Ubuntu")," under ",(0,a.kt)("inlineCode",{parentName:"p"},"/mnt"),". Therefore, store your files somewhere else than ",(0,a.kt)("inlineCode",{parentName:"p"},"/mnt"),". For example,\nyou could store them in your home directory (",(0,a.kt)("inlineCode",{parentName:"p"},"~"),")."),(0,a.kt)("p",null,"Also, make sure that you're running all commands from a ",(0,a.kt)("inlineCode",{parentName:"p"},"WSL 2")," terminal (",(0,a.kt)("inlineCode",{parentName:"p"},"$")," command prompt), i.e., from within ",(0,a.kt)("inlineCode",{parentName:"p"},"Ubuntu"),", not Windows PowerShell (",(0,a.kt)("inlineCode",{parentName:"p"},">")," command prompt).\nYou won't be able to run bash scripts from PowerShell."),(0,a.kt)("p",null,"On your Windows machine, ",(0,a.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows/wsl/wsl-config#ways-to-run-wsl"},"open the ",(0,a.kt)("inlineCode",{parentName:"a"},"Ubuntu")," terminal"),".\nNext, start ",(0,a.kt)("inlineCode",{parentName:"p"},"Docker Desktop"),". You can confirm that ",(0,a.kt)("inlineCode",{parentName:"p"},"Docker Desktop")," is running by typing ",(0,a.kt)("inlineCode",{parentName:"p"},"docker --version")," in the ",(0,a.kt)("inlineCode",{parentName:"p"},"Ubuntu")," terminal.\nIf you get a response you're now ready to run the ELN in a ",(0,a.kt)("a",{parentName:"p",href:"#eln-in-docker"},"Docker container")," or in a ",(0,a.kt)("a",{parentName:"p",href:"#eln-in-devcontainer"},"Visual Studio Code devcontainer"),"."),(0,a.kt)("h2",{id:"linux-heading-id"},"Linux"),(0,a.kt)("h3",{id:"dependencies-1"},"Dependencies"),(0,a.kt)("p",null,"Starting point is a fresh installation of a Linux operating system. This could be a physical or virtual machine.\nThe instructions have been tested on 64-bit Ubuntu Focal 20.04 (LTS). The following packages have to be installed:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"git"),(0,a.kt)("li",{parentName:"ul"},"docker"),(0,a.kt)("li",{parentName:"ul"},"docker-compose")),(0,a.kt)("h3",{id:"setup-1"},"Setup"),(0,a.kt)("p",null,"The dockerized installation of Chemotion ELN expects some folders to have numerical UID:GID of 1000:1000.\nThese are usually the UID and GID of the first unprivileged user on a fresh system.\nThroughout this guide, we assume the login of this user to be ",(0,a.kt)("inlineCode",{parentName:"p"},"user1"),".\nSome additional settings can be applied to ease the management of the development system."),(0,a.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Security implications")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"It is assumed that the development system is operated in a safe environment by a single user.\nThe settings proposed here should neither be applied to production machines nor in unsafe environments."))),(0,a.kt)("h4",{id:"docker-group"},"docker group"),(0,a.kt)("p",null,"Operation of the docker subsystem normally requires elevated privileges.\nAlthough granting docker access to unprivileged users comes with a security impact, this can be justified on a development system.\nTo grant management privileges for the docker subsystem, run the following commands:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"sudo bash\ngroupadd --system docker\nusermod -aG docker user1\nsnap disable docker\nsnap enable docker\nexit\n")),(0,a.kt)("p",null,"Other Linux distributions (Debian, openSUSE) set up their docker instances differently (e.g. the group ",(0,a.kt)("inlineCode",{parentName:"p"},"docker")," may already exist).\nFor these distributions, you may want to replace the ",(0,a.kt)("inlineCode",{parentName:"p"},"snap")," commands by :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"...\nsystemctl restart docker.service\n...\n")),(0,a.kt)("p",null,"In each case, the settings for ",(0,a.kt)("inlineCode",{parentName:"p"},"user1")," will become effective upon the next login."),(0,a.kt)("p",null,"You're now ready to run the ELN in a ",(0,a.kt)("a",{parentName:"p",href:"#eln-in-docker"},"Docker container")," or in a ",(0,a.kt)("a",{parentName:"p",href:"#eln-in-devcontainer"},"Visual Studio Code devcontainer"),"."),(0,a.kt)("h2",{id:"macos-heading-id"},"macOS"),(0,a.kt)("p",null,"We recommend having an Ubuntu virtual machine. Then you can follow the steps from ",(0,a.kt)("a",{parentName:"p",href:"#linux-heading-id"},"Linux installation"),"."),(0,a.kt)("h2",{id:"eln-in-docker"},"ELN in a Docker container"),(0,a.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"operating system requirements")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"Before proceeding, make sure you've followed the instructions for your operating system (",(0,a.kt)("a",{parentName:"p",href:"#windows-heading-id"},"Windows"),", ",(0,a.kt)("a",{parentName:"p",href:"#linux-heading-id"},"Linux"),", ",(0,a.kt)("a",{parentName:"p",href:"#macos-heading-id"},"macOS"),")."))),(0,a.kt)("p",null,"The code for a dockerized installation of Chemotion ELN is currently split into two repositories:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/ptrxyz/chemotion"},"https://github.com/ptrxyz/chemotion")," containing Dockerfiles and shell scripts for dockerization"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/ComPlat/chemotion_ELN"},"https://github.com/ComPlat/chemotion_ELN")," containing the ELN source code")),(0,a.kt)("p",null,"As a developer, you may want to replace one or both repositories by your own fork. In this case, you would have to replace the URLs in the code snippets given below.\nThere are two flavours of dockerized setups of Chemotion ELN:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"setup in development mode"),(0,a.kt)("li",{parentName:"ul"},"setup in production mode")),(0,a.kt)("h3",{id:"development-mode-setup"},"Development Mode Setup"),(0,a.kt)("p",null,"The development mode setup is straight forward and requires only a few steps. The setup starts by checking out the containerization scripts in the home directory:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"cd ~\ngit clone https://github.com/ptrxyz/chemotion.git\n")),(0,a.kt)("p",null,"The next step is to execute the following code snippet:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"cd chemotion/client-chemotion-dev\n./firstrun.sh\ndocker-compose up\n")),(0,a.kt)("p",null,"First, the script ",(0,a.kt)("inlineCode",{parentName:"p"},"firstrun.sh")," will clone / check out the Chemotion ELN source code.\nYou would have to adjust the URL if you would prefer to work on a fork of the repository.\nLater on, the script will be prompt you to type ",(0,a.kt)("inlineCode",{parentName:"p"},"continue")," to authorize a potentially destructive initialization of a fresh Chemotion ELN database.\nIn total, the code snippet will do the following:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"clone the Chemotion ELN source code into a subdirectory ",(0,a.kt)("inlineCode",{parentName:"li"},"src")),(0,a.kt)("li",{parentName:"ul"},"download a development container image for Chemotion ELN"),(0,a.kt)("li",{parentName:"ul"},"download a PostgreSQL container image and set up database for Chemotion ELN"),(0,a.kt)("li",{parentName:"ul"},"set up a Chemotion ELN container which mounts the source code of Chemotion ELN as a volume and run it in the foreground (to daemonize it and send it to the background, add option ",(0,a.kt)("inlineCode",{parentName:"li"},"-d")," to the last command)")),(0,a.kt)("p",null,"Thus any changes to the Chemotion ELN source code in the ",(0,a.kt)("inlineCode",{parentName:"p"},"src")," directory will be reflected in the running instance.\nThe status of the containers can be checked either with ",(0,a.kt)("inlineCode",{parentName:"p"},"docker ps")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"ss -tlpen")," which displays the TCP sockets where processes are listening for connections. After the start-up you can access your fresh instance using a browser. The application is running on ",(0,a.kt)("inlineCode",{parentName:"p"},"http://localhost:4000"),", the seeded administration account is ",(0,a.kt)("inlineCode",{parentName:"p"},"ADM")," (all caps!) with password ",(0,a.kt)("inlineCode",{parentName:"p"},"PleaseChangeYourPassword"),". The PostgreSQL database should listen on port 5432."),(0,a.kt)("p",null,"To tear things down, you can issue and the following command (in a different shell but from the same directory):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"docker-compose down --remove-orphans\n")),(0,a.kt)("p",null,"Additional possiblities to manage docker containers, images, networks and volumes are described in the ",(0,a.kt)("a",{parentName:"p",href:"https://docs.docker.com/engine/reference/commandline/cli/"},"Docker CLI")," manual."),(0,a.kt)("h3",{id:"production-mode-setup"},"Production Mode Setup"),(0,a.kt)("p",null,"For manual installation in production mode, a pre-built image from DockerHub is used.\nThe goal for this guide is to build our own production mode image instead.\nThis means, a few manual adjustments are necessary, otherwise the pre-built image from DockerHub would be used.\nThe procedure starts with checking out the containerization scripts (the repository checked out for a development mode setup can be re-used):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"cd ~\ngit clone https://github.com/ptrxyz/chemotion.git\n")),(0,a.kt)("p",null,"The next step is to modify the file ",(0,a.kt)("inlineCode",{parentName:"p"},"~/chemotion/build-chemotion/rebuild.sh"),". Any reference to ",(0,a.kt)("inlineCode",{parentName:"p"},"ptrxyz/chemotion")," must be updated.\nIn this guide, all occurences are changed to ",(0,a.kt)("inlineCode",{parentName:"p"},"user1/chemotion"),"."),(0,a.kt)("p",null,"The setup continues with the following steps:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"cd ~/chemotion/build-chemotion\ngit clone https://github.com/ComPlat/chemotion_ELN.git src\n./rebuild.sh\n")),(0,a.kt)("p",null,"Depending on your machine, this will take some time, as some packages will be compiled from source code.\nIn the end, the production mode image should be ready.\nCheck it with ",(0,a.kt)("inlineCode",{parentName:"p"},"docker images"),"; the command should display an image tagged ",(0,a.kt)("inlineCode",{parentName:"p"},"user1/chemotion:VERSION")," with ",(0,a.kt)("inlineCode",{parentName:"p"},"VERSION")," being a placeholder for the exact version.\nTo start an instance of ELN, the file ",(0,a.kt)("inlineCode",{parentName:"p"},"~/chemotion/client-chemotion/docker-compose.yml")," must be updated manually to reflect the correct image name.\nOriginally, the file references ",(0,a.kt)("inlineCode",{parentName:"p"},"ptrxyz/chemotion:VERSION")," in two places, which both must be updated to ",(0,a.kt)("inlineCode",{parentName:"p"},"user1/chemotion:VERSION"),".\nPlease note that an update of the version field might be necessary as well.\nAfter the update, the production mode Chemotion ELN can be started with the following commands:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"cd ~/chemotion/client-chemotion\nmkdir -p shared db-data\ndocker-compose run eln init\ndocker container prune\ndocker-compose up\n")),(0,a.kt)("p",null,"The third command will prompt you to authorize a potentially destructive initialization of a fresh database by typing ",(0,a.kt)("inlineCode",{parentName:"p"},"continue"),".\nThe fourth command will prompt prior to the removal of stopped containers.\nFor a real production mode environment additional steps would be required (e.g. setup of a HTTP proxy), which is beyond the scope of this guide."),(0,a.kt)("h2",{id:"eln-in-devcontainer"},"ELN in a Visual Studio Code devcontainer"),(0,a.kt)("p",null,"Make sure you have docker running. Create a folder where you want to keep Dockerfiles and shell scripts for dockerization and, in the terminal, clone the following ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/ptrxyz/chemotion/tree/chemotion-cli/client-vscode-remote-container"},"repository")," to it:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"git clone https://github.com/ptrxyz/chemotion.git\n")),(0,a.kt)("p",null,"On the ",(0,a.kt)("inlineCode",{parentName:"p"},"chemotion-cli")," branch, change into the ",(0,a.kt)("inlineCode",{parentName:"p"},"client-vscode-remote-container")," folder:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"cd chemotion/client-vscode-remote-container/\n")),(0,a.kt)("p",null,"Run the script ",(0,a.kt)("inlineCode",{parentName:"p"},"createWorkspace.sh")," which will create your work space containing chemotion codebase. Choose the directory where you want to have your codebase. Make sure it is an empty one. Here we will create a directory in home called ",(0,a.kt)("inlineCode",{parentName:"p"},"workspace")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"bash ./createWorkspace.sh ~/workspace\n")),(0,a.kt)("p",null,"When it is done, ",(0,a.kt)("inlineCode",{parentName:"p"},"workspace")," will open in VSCode. There, check the bell button in the bottom right corner for a new notification and choose ",(0,a.kt)("inlineCode",{parentName:"p"},"Reopen in Container"),". If you can't see the notification, check the bottom left side for an icon similar to ",(0,a.kt)("inlineCode",{parentName:"p"},"><")," in green. Press the icon, this will open a menu. From the menu choose ",(0,a.kt)("inlineCode",{parentName:"p"},"Reopen in Container"),". Building the container might take a little time. Then there is a post creation step which takes a while. When it is finished, open a new terminal in VSCode. Run:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"bundle exec rails c\n")),(0,a.kt)("p",null,"And then type quit"),(0,a.kt)("p",null,'And then start the server. Compiling "webpacker" takes a little time so wait a little for it:'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"bundle exec rails s\n")),(0,a.kt)("p",null,"One last step. If you start applying changes, you might get the error: ",(0,a.kt)("inlineCode",{parentName:"p"},"FATAL: Listen error: unable to monitor directories for changes."),", open a terminal and run:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'sudo sh -c "echo fs.inotify.max_user_watches=524288 >> /etc/sysctl.conf"\nsudo sysctl -p\n')),(0,a.kt)("p",null,"You are ready now. You can find more details in this ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/ptrxyz/chemotion/tree/chemotion-cli/client-vscode-remote-container"},"link")," and this ",(0,a.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=HZCAbC6ldzE"},"video"),"."),(0,a.kt)("h2",{id:"tools-recommended-for-development"},"Tools recommended for development"),(0,a.kt)("h3",{id:"visual-studio-code"},"Visual Studio Code"),(0,a.kt)("p",null,"In addition to the tools mentioned in the ",(0,a.kt)("a",{parentName:"p",href:"development/development"},"development chapter")," you can install the VS Code Docker extension. This extension adds the functionality to build, manage, and deploy containerized applications from inside VS Code. (You need the Remote-Container extension to actually use the container as your dev environment.)"))}m.isMDXComponent=!0}}]);