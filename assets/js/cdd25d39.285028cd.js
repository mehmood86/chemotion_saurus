"use strict";(self.webpackChunkchemotion_saurus=self.webpackChunkchemotion_saurus||[]).push([[9561],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,r=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=d(n),m=l,h=u["".concat(s,".").concat(m)]||u[m]||c[m]||r;return n?a.createElement(h,o(o({ref:t},p),{},{components:n})):a.createElement(h,o({ref:t},p))}));function m(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=n.length,o=new Array(r);o[0]=u;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:l,o[1]=i;for(var d=2;d<r;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},5705:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return i},contentTitle:function(){return s},metadata:function(){return d},toc:function(){return p},default:function(){return u}});var a=n(7462),l=n(3366),r=(n(7294),n(3905)),o=["components"],i={id:"dev_native_install",title:"Native Installation",sidebar_label:"Native installation",slug:"development_native_installation"},s=void 0,d={unversionedId:"eln/dev_native_install",id:"version-1.1.1/eln/dev_native_install",title:"Native Installation",description:"This documentation describes an installation solution of the chemotion ELN system for development purposes with Rails 5 on Ubuntu 20.04.",source:"@site/versioned_docs/version-1.1.1/eln/dev_native_install.mdx",sourceDirName:"eln",slug:"/eln/development_native_installation",permalink:"/chemotionsaurus/docs/eln/development_native_installation",editUrl:"https://github.com/ComPlat/chemotion_saurus/edit/master/versioned_docs/version-1.1.1/eln/dev_native_install.mdx",tags:[],version:"1.1.1",lastUpdatedBy:"Danny Truong",lastUpdatedAt:1650478097,formattedLastUpdatedAt:"4/20/2022",frontMatter:{id:"dev_native_install",title:"Native Installation",sidebar_label:"Native installation",slug:"development_native_installation"},sidebar:"elnSidebar",previous:{title:"Docker installation",permalink:"/chemotionsaurus/docs/eln/docker_installation"},next:{title:"Docker installation",permalink:"/chemotionsaurus/docs/eln/development_docker_installation"}},p=[{value:"Before Installation",id:"before-installation",children:[],level:2},{value:"Get the installation script",id:"get-the-installation-script",children:[{value:"Errors during installation",id:"errors-during-installation",children:[],level:4}],level:2},{value:"After Installation",id:"after-installation",children:[{value:"Git clone",id:"git-clone",children:[],level:3},{value:"Change configuration files",id:"change-configuration-files",children:[],level:3},{value:"Install Ruby libraries",id:"install-ruby-libraries",children:[{value:"Errors",id:"errors",children:[],level:4}],level:3},{value:"Install node_modules",id:"install-node_modules",children:[{value:"Errors",id:"errors-1",children:[],level:4}],level:3},{value:"Update database",id:"update-database",children:[{value:"Errors",id:"errors-2",children:[],level:4}],level:3},{value:"Migrate data",id:"migrate-data",children:[],level:3},{value:"Run the app",id:"run-the-app",children:[{value:"Errors",id:"errors-3",children:[],level:4}],level:3},{value:"Update test data",id:"update-test-data",children:[],level:3},{value:"For old installations: Upgrade from Rails 4 to Rails 5",id:"for-old-installations-upgrade-from-rails-4-to-rails-5",children:[],level:3}],level:2}],c={toc:p};function u(e){var t=e.components,n=(0,l.Z)(e,o);return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"This documentation describes an installation solution of the chemotion ELN system for development purposes with Rails 5 on Ubuntu 20.04.  "),(0,r.kt)("h2",{id:"before-installation"},"Before Installation"),(0,r.kt)("p",null,"The installation script installs ELN through a default user, which is created during the installation. If you want to use another user or use an existing user, download the installation script (see ",(0,r.kt)("a",{parentName:"p",href:"#get-installation-script"},"Get installation script"),") and change the varibale PROD at the top of the script.",(0,r.kt)("br",{parentName:"p"}),"\n","For the default user a random password is generated when newly created. If you want to login to the user after installation you can change the password in the script. For that search for the command ",(0,r.kt)("inlineCode",{parentName:"p"},"chpasswd")," in the script."),(0,r.kt)("h2",{id:"get-the-installation-script"},"Get the installation script"),(0,r.kt)("p",null,"Download the current development installation script (14.07.2021) from ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ComPlat/chemotion_ELN/tree/development-5/scripts"},"GitHub")," and make it executable:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"curl -o install_development.sh -L https://raw.githubusercontent.com/ComPlat/chemotion_ELN/development-5/scripts/install_development.sh\nchmod 700 install_development.sh\nsudo ./install_development.sh\n")),(0,r.kt)("p",null,"Or install the current script directly via curl:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"sudo curl -o- https://raw.githubusercontent.com/ComPlat/chemotion_ELN/development-5/scripts/install_development.sh | bash\n")),(0,r.kt)("h4",{id:"errors-during-installation"},"Errors during installation"),(0,r.kt)("div",{class:"boxBorder"},'You need to run "nvm install vxx.xx.x" to install it before using it.'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"nvm install vxx.xx.x\n")),(0,r.kt)("p",null,"Run the installation script again:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"sudo ./install_development.sh\n")),(0,r.kt)("p",null,"Another solution could be to comment out PART_5 in the installation script, where nvm and Node will be installed and run again:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"sudo ./install_development.sh\n")),(0,r.kt)("div",{class:"boxBorder"},"curl: (23) Failed writing body"),(0,r.kt)("p",null,"Extended error message:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Warning: Failed to create the file /tmp/x.x.x: Permission \nWarning: denied\n  0 13.6M    0  1369    0     0   8398      0  0:28:19 --:--:--  0:28:19  8398\ncurl: (23) Failed writing body (0 != 1369)\n000:09 removing tmp files..\n000:09 removing tmp repo..\n000:09 An error has occured\n")),(0,r.kt)("p",null,"This may occure if you install the chemotion ELN for multiple users on the same machine, because the global packages to be installed already exists, so either comment out the installation of the package which causes the problem or delete it."),(0,r.kt)("h2",{id:"after-installation"},"After Installation"),(0,r.kt)("h3",{id:"git-clone"},"Git clone"),(0,r.kt)("p",null,"After the installation of the desired libraries to use the chemotion ELN you need to clone the source code from ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ComPlat/chemotion_ELN"},"GitHub"),"."),(0,r.kt)("h3",{id:"change-configuration-files"},"Change configuration files"),(0,r.kt)("p",null,"Before using the chemotion ELN you have to change some configurations. Change to the root folder of your ELN (e. g. ",(0,r.kt)("inlineCode",{parentName:"p"},"cd ~/chemotion_ELN"),") and paste the following commands at once in your terminal:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"cp Gemfile.plugin.example Gemfile.plugin ;\ncp .ruby-gemset.example .ruby-gemset ;\ncp .ruby-version.example .ruby-version ;\ncp ./config/database.yml.example ./config/database.yml ;\ncp ./config/datacollectors.yml.example ./config/datacollectors.yml ;\ncp ./config/editors.yml.example ./config/editors.yml ;\ncp ./config/inference.yml.example ./config/inference.yml ;\ncp ./config/spectra.yml.example ./config/spectra.yml ;\ncp ./config/storage.yml.example ./config/storage.yml ;\ncp ./config/user_props.yml.example ./config/user_props.yml\n")),(0,r.kt)("h3",{id:"install-ruby-libraries"},"Install Ruby libraries"),(0,r.kt)("p",null,"Change to the root folder of your ELN (e. g. ",(0,r.kt)("inlineCode",{parentName:"p"},"cd ~/chemotion_ELN"),") where the ",(0,r.kt)("inlineCode",{parentName:"p"},"Gemfile")," is located and type:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"source ~/.rvm/scripts/rvm && bundle install\n")),(0,r.kt)("h4",{id:"errors"},"Errors"),(0,r.kt)("div",{class:"boxBorder"},"You might have to install separate package for the ruby development environment, ruby-dev or ruby-devel for example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"sudo apt-get install ruby-full\n")),(0,r.kt)("h3",{id:"install-node_modules"},"Install node_modules"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"source ~/.nvm/nvm.sh && yarn install\n")),(0,r.kt)("h4",{id:"errors-1"},"Errors"),(0,r.kt)("div",{class:"boxBorder"},"ERROR: [Errno 2] No such file or directory: 'install'"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"sudo apt-get remove --purge cmdtest\nsource ~/.nvm/nvm.sh && nvm use 14.16.0 && npm install -g yarn && yarn install\n")),(0,r.kt)("h3",{id:"update-database"},"Update database"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"sudo -u postgres psql\nALTER USER postgres PASSWORD '<your password>';\n")),(0,r.kt)("p",null,"Open file ",(0,r.kt)("inlineCode",{parentName:"p"},"./config/databse.yml"),", change host in development to ",(0,r.kt)("inlineCode",{parentName:"p"},"localhost")," and update your password that you set above."),(0,r.kt)("h4",{id:"errors-2"},"Errors"),(0,r.kt)("div",{class:"boxBorder"},'FATAL:  database "chemotion_dev" does not exist (ActiveRecord::NoDatabaseError)'),(0,r.kt)("p",null,"Either the database settings in the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ComPlat/chemotion_ELN/blob/development-5/config/database.yml.example"},"yml configuration file")," needs to be changed or the database needs to be created in Postgres."),(0,r.kt)("h3",{id:"migrate-data"},"Migrate data"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"bundle exec rake db:create RAILS_ENV=development\nbundle exec rake db:migrate RAILS_ENV=development\n")),(0,r.kt)("h3",{id:"run-the-app"},"Run the app"),(0,r.kt)("p",null,"You need to run two servers simultaneously in two different terminals: one for the rails app and one for webpack:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"bundle exec rails s\nbundle exec bin/webpack-dev-server\n")),(0,r.kt)("p",null,"Potentially a restart of the Rails server is needed because changes in JavaScript files below ",(0,r.kt)("inlineCode",{parentName:"p"},"app/")," are monitored by the webpack server process."),(0,r.kt)("h4",{id:"errors-3"},"Errors"),(0,r.kt)("div",{class:"boxBorder"},"Undefined method `new' for BigDecimal:Class (NoMethodError)"),(0,r.kt)("p",null,"Open ",(0,r.kt)("inlineCode",{parentName:"p"},"Gemfile")," and add:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gem 'bigdecimal', '1.3.5'\n")),(0,r.kt)("p",null,"Run again:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"bundle install\n")),(0,r.kt)("p",null,"Restart the servers. "),(0,r.kt)("div",{class:"boxBorder"},"yarn run v1.22.10",(0,r.kt)("p",null,'error Command "webpack" not found.'),(0,r.kt)("p",null,"info Visit ",(0,r.kt)("a",{parentName:"p",href:"https://yarnpkg.com/en/docs/cli/run"},"https://yarnpkg.com/en/docs/cli/run")," for documentation about this command.")),(0,r.kt)("div",{class:"boxBorder"},"Unable to run node_modules/.bin/browserify. Ensure you have installed it with npm. (BrowserifyRails::BrowserifyError)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"source ~/.nvm/nvm.sh && nvm use 14.16.0 && yarn install\n")),(0,r.kt)("p",null,"Restart the servers. "),(0,r.kt)("h3",{id:"update-test-data"},"Update test data"),(0,r.kt)("p",null,"Open web browser, signup and login. Download and import data from ",(0,r.kt)("a",{parentName:"p",href:"https://bwsyncandshare.kit.edu/s/kzpd8B5XdjMQ8gw"},"here"),".",(0,r.kt)("br",{parentName:"p"}),"\n","Run:  "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"bundle exec bin/delayed_job start\n")),(0,r.kt)("h3",{id:"for-old-installations-upgrade-from-rails-4-to-rails-5"},"For old installations: Upgrade from Rails 4 to Rails 5"),(0,r.kt)("p",null,'If you have an existing installation with Rails 4 and want to upgrade to Rails 5 you need to "update" your Ruby gems and node modules with yarn after checking out the development-5 branch:'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"bundle install\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"source ~/.nvm/nvm.sh && nvm install 14.16.0\nsource ~/.nvm/nvm.sh && nvm use 14.16.0 && npm install -g npm && npm install -g yarn && yarn install\n")),(0,r.kt)("p",null,"For a clean install it might be helpful - but not always required - to remove the previous packages that were installed by npm, only need to be done once:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"rm -rf node_modules\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"source ~/.nvm/nvm.sh && nvm use 14.16.0 && yarn install\n")),(0,r.kt)("p",null,"You need to run two servers simultaneously in two different terminals: one for the rails app and one for webpack:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"bundle exec rails s\nbundle exec bin/webpack-dev-server\n")),(0,r.kt)("p",null,"Potentially a restart of the Rails server is needed because changes in the JavaScript files below ",(0,r.kt)("inlineCode",{parentName:"p"},"app/")," are monitored by the webpack server process."))}u.isMDXComponent=!0}}]);